CREATE TABLE IF NOT EXISTS Users (
        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
        name varchar NOT NULL,
        email varchar NOT NULL,
        CONSTRAINT UQ_USER_EMAIL UNIQUE (email)
);
CREATE TABLE IF NOT EXISTS Items (
        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
        name varchar NOT NULL,
        description varchar NOT NULL,
        available boolean NOT NULL,
        owner_id BIGINT NOT NULL,
        CONSTRAINT FK_ITEM_ON_OWNER FOREIGN KEY (owner_id) REFERENCES users (id)
);

CREATE TABLE IF NOT EXISTS Booking (
        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
        start_time TIMESTAMP WITHOUT TIME ZONE NOT NULL,
        end_time TIMESTAMP WITHOUT TIME ZONE NOT NULL,
        item_id BIGINT NOT NULL,
        booker_id BIGINT NOT NULL,
        status varchar(18) NOT NULL,
        CONSTRAINT START_IS_BEFORE_END CHECK(start_time<=end_time),
        CONSTRAINT FK_BOOKING_ON_BOOKER FOREIGN KEY (booker_id) REFERENCES users (id),
        CONSTRAINT FK_BOOKING_ON_ITEM FOREIGN KEY (item_id) REFERENCES items (id)
);

CREATE TABLE IF NOT EXISTS Comments(
        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
        text varchar NOT NULL,
        author_id BIGINT NOT NULL,
        item_id BIGINT NOT NULL,
        created TIMESTAMP WITHOUT TIME ZONE NOT NULL,
        CONSTRAINT FK_COMMENT_ON_AUTHOR FOREIGN KEY (author_id) REFERENCES users (id),
        CONSTRAINT FK_COMMENT_ON_ITEM FOREIGN KEY (item_id) REFERENCES items (id)
)